// Generated by js_of_ocaml
//# buildInfo:effects=true, kind=cmo, use-js-string=true, version=5.7.1+5.7.1

//# unitInfo: Provides: Dune__exe__Indent
//# unitInfo: Requires: Assert_failure, Dune__exe__Ocp_indent, Js_of_ocaml__Js, Stdlib, Stdlib__List, Stdlib__String
(function
  (globalThis){
   "use strict";
   var
    runtime = globalThis.jsoo_runtime,
    caml_maybe_attach_backtrace = runtime.caml_maybe_attach_backtrace,
    caml_string_of_jsstring = runtime.caml_string_of_jsstring;
   function caml_cps_call2(f, a0, a1){
    return runtime.caml_stack_check_depth()
            ? (f.l
                >= 0
                ? f.l
                : f.l = f.length)
              == 2
              ? f(a0, a1)
              : runtime.caml_call_gen(f, [a0, a1])
            : runtime.caml_trampoline_return(f, [a0, a1]);
   }
   function caml_cps_call3(f, a0, a1, a2){
    return runtime.caml_stack_check_depth()
            ? (f.l
                >= 0
                ? f.l
                : f.l = f.length)
              == 3
              ? f(a0, a1, a2)
              : runtime.caml_call_gen(f, [a0, a1, a2])
            : runtime.caml_trampoline_return(f, [a0, a1, a2]);
   }
   function caml_cps_call4(f, a0, a1, a2, a3){
    return runtime.caml_stack_check_depth()
            ? (f.l
                >= 0
                ? f.l
                : f.l = f.length)
              == 4
              ? f(a0, a1, a2, a3)
              : runtime.caml_call_gen(f, [a0, a1, a2, a3])
            : runtime.caml_trampoline_return(f, [a0, a1, a2, a3]);
   }
   function caml_cps_exact_call4(f, a0, a1, a2, a3){
    return runtime.caml_stack_check_depth()
            ? f(a0, a1, a2, a3)
            : runtime.caml_trampoline_return(f, [a0, a1, a2, a3]);
   }
   runtime.jsoo_create_file
    ("/static/cmis/dune__exe__Indent.cmi",
     "Caml1999I032\x84\x95\xa6\xbe\0\0\0\xb1\0\0\0&\0\0\0\x89\0\0\0\x80\xa01Dune__exe__Indent\xa0\xb0\xa0(textarea\x01\x04\r\xd0\xc0\xc1@\xc0\xb3\xa1\xa1\x90\x92+Js_of_ocaml\"Js!t\xa0\xc0\xb3\xa1\xa1\x04\n(Dom_html/textAreaElement@\x90@\x02\x05\xf5\xe1\0@\0\xfb@\x90@\x02\x05\xf5\xe1\0@\0\xfc\xc0\xb3\x90\xa3$unitF@\x90@\x02\x05\xf5\xe1\0@\0\xfd@\x02\x05\xf5\xe1\0@\0\xfe@\xb0\xc0*indent.mliCRR\xc0\x04\x02CR\0F@@\xa1\x04%@@@\x84\x95\xa6\xbe\0\0\x02\0\0\0\0F\0\0\x01\x12\0\0\0\xda\xa0\xa01Dune__exe__Indent\x900\xa5|S\x9cF\xd3\xca/\xd7\xcb(\xc7\xa2\xe4\x1aT\xa0\xa0-Stdlib__Uchar\x900\x9e\xa8d\bP\x95\x97\fs\xb7\xb1|&\xc3s\x17\xa0\xa0/Stdlib__Complex\x900\xd5\xf0A\xcc\xbe\x97\x83\xaf\x90\xca83p\x02\xfbN\xa0\xa00Stdlib__Bigarray\x900U\xa8\x12\xd9\xa3\xc8\x9ez\x8e\xbb\x91~c\xe4\xbe\xea\xa0\xa0&Stdlib\x900\x85\xf8]\xdbG\xed\xc0\xc7W\x96W\xee\xe7@0-\xa0\xa08Js_of_ocaml__Typed_array\x900[W\xdd\xe9!\xd8\x0b\xa9\x81\x16\xf4j\x8e-\xd2\x9b\xa0\xa0/Js_of_ocaml__Js\x900;\xf2\xa5\xb5?\xc5\xf8\x85:r\x99\x03\xd9\xc9\xdb\xc2\xa0\xa01Js_of_ocaml__File\x900\x90\xf9I\xd23Q\xa6W+J\xb2\xd4\x9a\xeaM\xf6\xa0\xa05Js_of_ocaml__Dom_html\x900\xedMV\xa6za\xb0]\x8cy\xb5\x04xq\xb7W\xa0\xa00Js_of_ocaml__Dom\x900\xb7\x88ei\xb1Q\x0e\x9d\xe7\b[\x9by\xa4\xad\x8b\xa0\xa0-Js_of_ocaml__\x900\xcaj\xb7\x86\x16\t\xf3\xe0A\xc5\xee>Dn\x9f\x1f\xa0\xa0+Js_of_ocaml\x9006@}(\xe5\x12|@\x7f\xe4Gs\xe0\xd2\x1f\x07\xa0\xa0)Dune__exe\x900\xf7\x89\x12\x11g'<\xecF\x04{8\x98\xa8\x06P\xa0\xa08CamlinternalFormatBasics\x900\xce\xcf\xaf\xd5\xc0!G?^5\x8c\x96\xacu\x02\xa0@\x84\x95\xa6\xbe\0\0\0\b\0\0\0\x04\0\0\0\x0b\0\0\0\x0b\xa0@\xa0A\xa0\x90@@");
   var
    global_data = runtime.caml_get_global_data(),
    Stdlib_String = global_data.Stdlib__String,
    Stdlib_List = global_data.Stdlib__List,
    Assert_failure = global_data.Assert_failure,
    Js_of_ocaml_Js = global_data.Js_of_ocaml__Js,
    Dune_exe_Ocp_indent = global_data.Dune__exe__Ocp_indent,
    Stdlib = global_data.Stdlib,
    _a_ = [0, "indent.ml", 12, 12],
    _b_ = [0, 0, 0],
    _c_ = [0, 0, 0];
   function textarea(textbox, cont){
    function loop(s, acc, param, cont){
     var pos = param[2], i = param[1];
     runtime.caml_push_trap
      (function(_r_){
        return caml_cps_call2
                (Stdlib_List[9],
                 [0, [0, i, [0, pos, runtime.caml_ml_string_length(s)]], acc],
                 cont);
       });
     return caml_cps_call4
             (Stdlib_String[31],
              s,
              pos,
              10,
              function(pos$0){
               return caml_cps_exact_call4
                       (loop,
                        s,
                        [0, [0, i, [0, pos, pos$0]], acc],
                        [0, i + 1 | 0, pos$0 + 1 | 0],
                        function(_q_){runtime.caml_pop_trap(); return cont(_q_);});
              });
    }
    function find(l, c){
     var l$0 = l;
     for(;;){
      if(! l$0)
       throw caml_maybe_attach_backtrace([0, Assert_failure, _a_], 1);
      var
       _p_ = l$0[1],
       match = _p_[2],
       lo = match[1],
       i = _p_[1],
       up = match[2];
      if(c <= up) return [0, c, i, lo, up];
      var rem = l$0[2], l$0 = rem;
     }
    }
    var
     v = textbox.value,
     c1 = textbox.selectionStart,
     c2 = textbox.selectionEnd;
    return caml_cps_call2
            (Js_of_ocaml_Js[5][2],
             c1,
             function(_d_){
              return caml_cps_call2
                      (Js_of_ocaml_Js[5][5],
                       _d_,
                       function(_e_){
                        function _g_(pos){
                         if(pos)
                          var
                           _k_ = pos[1],
                           line2 = _k_[2][2],
                           line1 = _k_[1][2],
                           f =
                             function(l, cont){
                              var
                               _n_ = (line1 + 1 | 0) <= l ? 1 : 0,
                               _o_ = _n_ ? l <= (line2 + 1 | 0) ? 1 : 0 : _n_;
                              return cont(_o_);
                             };
                         else
                          var f = function(param, cont){return cont(1);};
                         return caml_cps_call3
                                 (Dune_exe_Ocp_indent[1],
                                  caml_string_of_jsstring(v),
                                  f,
                                  function(v){
                                   var t3 = runtime.caml_jsstring_of_string(v);
                                   textbox.value = t3;
                                   if(! pos) return cont(0);
                                   var
                                    _l_ = pos[1],
                                    _m_ = _l_[2],
                                    up2 = _m_[4],
                                    line2 = _m_[2],
                                    c2 = _m_[1],
                                    match = _l_[1],
                                    up1 = match[4],
                                    line1 = match[2],
                                    c1 = match[1];
                                   return caml_cps_exact_call4
   (loop,
    v,
    0,
    _c_,
    function(l){
     return caml_cps_call3
             (Stdlib_List[46],
              line1,
              l,
              function(match){
               var up1$0 = match[2], lo1 = match[1];
               return caml_cps_call3
                       (Stdlib_List[46],
                        line2,
                        l,
                        function(match){
                         var up2$0 = match[2], lo2 = match[1];
                         return caml_cps_call3
                                 (Stdlib[17],
                                  (c1 + up1$0 | 0) - up1 | 0,
                                  lo1,
                                  function(n1){
                                   return caml_cps_call3
   (Stdlib[17],
    (c2 + up2$0 | 0) - up2 | 0,
    lo2,
    function(n2){
     textbox.setSelectionRange(n1, n2);
     textbox.focus();
     return cont(0);
    });
                                  });
                        });
              });
    });
                                  });
                        }
                        function _f_(){return _g_(0);}
                        return _e_
                                ? caml_cps_call2
                                  (Js_of_ocaml_Js[5][2],
                                   c2,
                                   function(_h_){
                                    return caml_cps_call2
    (Js_of_ocaml_Js[5][5],
     _h_,
     function(_i_){
      return _i_
              ? caml_cps_exact_call4
                (loop,
                 caml_string_of_jsstring(v),
                 0,
                 _b_,
                 function(l){
                  var _j_ = find(l, c2);
                  return _g_([0, [0, find(l, c1), _j_]]);
                 })
              : _f_();
     });
                                   })
                                : _f_();
                       });
             });
   }
   var Dune_exe_Indent = [0, textarea];
   runtime.caml_register_global(15, Dune_exe_Indent, "Dune__exe__Indent");
   return;
  }
  (globalThis));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLjAsImZpbGUiOiIudG9wbGV2ZWwuZW9ianMvanNvby9kdW5lX19leGVfX0luZGVudC5jbW8uanMiLCJzb3VyY2VSb290IjoiIiwibmFtZXMiOlsidGV4dGFyZWEiLCJ0ZXh0Ym94IiwibG9vcCIsInMiLCJhY2MiLCJwb3MiLCJpIiwicG9zJDAiLCJmaW5kIiwibCIsImMiLCJsJDAiLCJsbyIsInVwIiwicmVtIiwidiIsImMxIiwiYzIiLCJsaW5lMiIsImxpbmUxIiwiZiIsInVwMiIsInVwMSIsInVwMSQwIiwibG8xIiwidXAyJDAiLCJsbzIiLCJuMSIsIm4yIl0sInNvdXJjZXMiOlsiL3dvcmtzcGFjZV9yb290L2luZGVudC5tbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0c7Ozs7Ozs7Ozs7O0c7Ozs7Ozs7Ozs7O0c7Ozs7Ozs7Ozs7O0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7WUFFSUEsU0FBVUM7SUFDWixTQUFRQyxLQUFLQyxHQUFFQztTQUFRQyxnQkFBSEM7OztRQUlDLE9BQUE7O3lCQUpEQSxPQUFHRCxtQ0FBVkYsTUFBRUM7OztLQUVELE9BQUE7O2NBRkREO2NBQVVFOzt1QkFFZkU7ZUFDSixPQUFBO3dCQUhJTDt3QkFBS0M7Z0NBQU9HLE9BQUdELEtBRWZFLFNBRk9IOzRCQUFLRSxXQUVaQztzQyx5QkFDSjs7O0lBR0osU0FBUUMsS0FBTUMsR0FBOEJDO0tBQzFDLElBRFlDLE1BQUFGO0tBQ1o7V0FEWUU7T0FFSixNQUFBOzthQUZJQTs7T0FHTEM7T0FBSk47T0FBUU87U0FIK0JILEtBRy9CRyxJQUEwQixXQUhLSCxHQUd2Q0osR0FBSU0sSUFBSUM7VUFIQ0MsTUFBQUgsUUFBQUEsTUFBQUc7O0lBSTBCOztLQUVwQ0MsSUFiUWQ7S0FlTmUsS0FmTWY7S0FlNEJnQixLQWY1QmhCO0lBZ0JLLE9BQUE7O2FBRFhlOztjQUNELE9BQUE7Ozs7cUNBRkRYO3lCQVFKLEdBUklBOztpQ0FBQUE7MkJBV3NDYTsyQkFBMUJDOzJCQUhaQztzQ0FJTVg7OEJBQUs7c0NBRENVLGtCQUNOVjsyQ0FBQUEsTUFEZ0NTOzs2QkFDSzs7OEJBSjNDRSwwQkFFaUIsZUFBSTt5QkFJakIsT0FBQTs7a0NBQWtCLHdCQWZ0Qkw7a0NBU0FLOzJDQU1BTDttQ0FDZSxTQUFBLGdDQURmQTttQ0E1QlFkO3dDQWNSSSxLQTBCTTs7MENBMUJOQTs7b0NBaUI4Q2dCO29DQUFiSDtvQ0FBSkQ7O29DQUFQSztvQ0FBYkg7b0NBQUpIO21DQUNHLE9BQUE7SUEvQkpkO0lBMkJKYTs7O2FBSUlOO0tBQ2UsT0FBQTs7Y0FGVlU7Y0FDTFY7O21CQUNPYyxrQkFBUEM7ZUFDZSxPQUFBOzt3QkFIY047d0JBQzdCVDs7NkJBRU9nQixrQkFBUEM7eUJBQ0ssT0FBQTs7bUNBSkpWLEtBRU1PLGFBRldEO2tDQUVsQkU7MkNBRUFHO21DQUNLLE9BQUE7O0tBTG9CVixLQUdsQlEsYUFIbUNKO0lBRzFDSzthQUVBRTtLQXBDSTNCLDBCQW1DSjBCLElBQ0FDO0tBcENJM0I7S0FzQ1I7Ozs7Ozs7O3VDQWxCRyxjQUFJO3dCQUpOO2tDQUE4Qzs7bUNBRFhnQjs7b0NBQ0QsT0FBQTs7OztNQUFBO2dCQUUzQjtpQkFqQkpmO2lCQWlCUyx3QkFMYmE7OzswQkFLSU47a0JBQ2EsVUFaYkQsS0FXQUMsR0FIZ0NRO3FDQVJoQ1QsS0FXQUMsR0FIRk87Ozs7Ozs7Ozs2QkFmSmhCOzs7RSIsInNvdXJjZXNDb250ZW50IjpbIm9wZW4gSnNfb2Zfb2NhbWxcblxubGV0IHRleHRhcmVhICh0ZXh0Ym94IDogRG9tX2h0bWwudGV4dEFyZWFFbGVtZW50IEpzLnQpIDogdW5pdCA9XG4gIGxldCByZWMgbG9vcCBzIGFjYyAoaSwgcG9zJykgPVxuICAgIHRyeVxuICAgICAgbGV0IHBvcyA9IFN0cmluZy5pbmRleF9mcm9tIHMgcG9zJyAnXFxuJyBpblxuICAgICAgbG9vcCBzICgoaSwgKHBvcycsIHBvcykpIDo6IGFjYykgKHN1Y2MgaSwgc3VjYyBwb3MpXG4gICAgd2l0aCBfIC0+IExpc3QucmV2ICgoaSwgKHBvcycsIFN0cmluZy5sZW5ndGggcykpIDo6IGFjYylcbiAgaW5cbiAgbGV0IHJlYyBmaW5kIChsIDogKGludCAqIChpbnQgKiBpbnQpKSBsaXN0KSBjID1cbiAgICBtYXRjaCBsIHdpdGhcbiAgICB8IFtdIC0+IGFzc2VydCBmYWxzZVxuICAgIHwgKGksIChsbywgdXApKSA6OiBfIHdoZW4gdXAgPj0gYyAtPiBjLCBpLCBsbywgdXBcbiAgICB8IChfLCAoX2xvLCBfdXApKSA6OiByZW0gLT4gZmluZCByZW0gY1xuICBpblxuICBsZXQgdiA9IHRleHRib3gjIy52YWx1ZSBpblxuICBsZXQgcG9zID1cbiAgICBsZXQgYzEgPSB0ZXh0Ym94IyMuc2VsZWN0aW9uU3RhcnQgYW5kIGMyID0gdGV4dGJveCMjLnNlbGVjdGlvbkVuZCBpblxuICAgIGlmIEpzLk9wdC50ZXN0IChKcy5PcHQucmV0dXJuIGMxKSAmJiBKcy5PcHQudGVzdCAoSnMuT3B0LnJldHVybiBjMilcbiAgICB0aGVuXG4gICAgICBsZXQgbCA9IGxvb3AgKEpzLnRvX3N0cmluZyB2KSBbXSAoMCwgMCkgaW5cbiAgICAgIFNvbWUgKGZpbmQgbCBjMSwgZmluZCBsIGMyKVxuICAgIGVsc2UgTm9uZVxuICBpblxuICBsZXQgZiA9XG4gICAgbWF0Y2ggcG9zIHdpdGhcbiAgICB8IE5vbmUgLT4gZnVuIF8gLT4gdHJ1ZVxuICAgIHwgU29tZSAoKF9jMSwgbGluZTEsIF9sbzEsIF91cDEpLCAoX2MyLCBsaW5lMiwgX2xvMiwgX3VwMikpIC0+XG4gICAgICAgIGZ1biBsIC0+IGwgPj0gbGluZTEgKyAxICYmIGwgPD0gbGluZTIgKyAxXG4gIGluXG4gIGxldCB2ID0gT2NwX2luZGVudC5pbmRlbnQgKEpzLnRvX3N0cmluZyB2KSBmIGluXG4gIHRleHRib3gjIy52YWx1ZSA6PSBKcy5zdHJpbmcgdjtcbiAgbWF0Y2ggcG9zIHdpdGhcbiAgfCBTb21lICgoYzEsIGxpbmUxLCBfbG8xLCB1cDEpLCAoYzIsIGxpbmUyLCBfbG8yLCB1cDIpKSAtPlxuICAgICAgbGV0IGwgPSBsb29wIHYgW10gKDAsIDApIGluXG4gICAgICBsZXQgbG8xJycsIHVwMScnID0gTGlzdC5hc3NvYyBsaW5lMSBsIGluXG4gICAgICBsZXQgbG8yJycsIHVwMicnID0gTGlzdC5hc3NvYyBsaW5lMiBsIGluXG4gICAgICBsZXQgbjEgPSBtYXggKGMxICsgdXAxJycgLSB1cDEpIGxvMScnIGluXG4gICAgICBsZXQgbjIgPSBtYXggKGMyICsgdXAyJycgLSB1cDIpIGxvMicnIGluXG4gICAgICBsZXQgKCkgPSAoT2JqLm1hZ2ljIHRleHRib3gpIyNzZXRTZWxlY3Rpb25SYW5nZSBuMSBuMiBpblxuICAgICAgdGV4dGJveCMjZm9jdXM7XG4gICAgICAoKVxuICB8IE5vbmUgLT4gKClcbiJdfQ==
